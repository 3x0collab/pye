{% extends 'layouts/base.html' %}
{% load static %}
{% load humanize %}

{% block title %} UI Tables {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}

<style type="text/css">
	
	/* Dropdown Button */
.dropbtn {
  font-size: 14px;
  border: none;
  height: 40px;
}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute; 
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {color: #3e8e41;}
 
/* Modal Header */
#deleteModal .modal-header {
  padding: 2px 16px;
  background-color: #051837;
  color: white;
}

#chatModal .modal-header {
  background-color: #051837;
  color: white;
    padding: 2px 16px;
}
#shareModal .modal-header {
  background-color: #051837;
  color: white;
    padding: 2px 16px;
}


/* Modal Header */
#exampleModal .modal-header {
  padding: 2px 16px;
  background-color: #051837;
  color: white;
}

/* Modal Content */
#exampleModal  .modal-content {
  position: relative; 
  margin: auto;
  padding: 0; 
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
  animation-name: animatetop;
  animation-duration: 0.4s
}


#exampleModal  .modal-footer {
  padding: 0px; 
  color: white;
  padding-right: 12px;
  padding-top: 7px;
  background-color: white;
}
/* Modal Body */
.modal-body {padding: 0px !important;}

/* Modal Footer */
#chatModal .modal-footer {
  padding: 0px; 
  color: white;
  width: 50%;
  margin: 4px;
  border: 1px solid #dee2e6 !important;
  box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
      border-radius: 13px;
}

/* Modal Content */
#deleteModal  .modal-content {
  position: relative; 
  margin: auto;
  padding: 0; 
  width: 70%;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
  animation-name: animatetop;
  animation-duration: 0.4s
}

#chatModal .modal-content {
  position: relative; 
  margin: auto;
  padding: 0; 
  width: 100%;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
  animation-name: animatetop;
  animation-duration: 0.4s
}



/* Add Animation */
@keyframes animatetop {
  from {top: -300px; opacity: 0}
  to {top: 20; opacity: 1}
}


 .user-icon {
 	width: 30px;
    height: 30px;
    border: 1px solid silver;
    padding: 4px;
    border-radius: 4px;
    margin-right: 15px;
 }

    .message {
      padding: 12px;
      margin-bottom: 10px;
    }

    .user-message {
/*      background-color: #f5f5f5;*/
      padding: 6px;
/*    border-radius: 4px;*/
/*    font-family: 'Courier New', monospace;*/
    font-size: 14px;
    line-height: 1.5;
/*    color: #333;*/
    overflow-x: auto;
    text-wrap: wrap;
    }

 #chatbot:hover {
 box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
}

.edit-icon {
	float: right;
}

.message {
	    display: flex;
}

input {
  min-height: 40px;
}

pre {
      padding: 15px;
    font-size: 14px;
    line-height: 1.5;
    color: #333;
    overflow-x: auto;
    text-wrap: wrap;
        background-color: #dcdcdc5e; 
        width: 100%;
}

.flex-container {
        padding-left:10px ;
            display: flex;
    justify-content: flex-start;
    align-items: center;
    min-height: 50px;
}

}



/* Bootstrap 4 text input with search icon */

.has-search .form-control {
    padding-left: 2.375rem;
}

.has-search .form-control-feedback {
    position: absolute;
    z-index: 2;
    display: block;
    width: 2.375rem;
    height: 2.375rem;
    line-height: 2.375rem;
    text-align: center;
    pointer-events: none;
    color: #aaa;
}

.menu-icon .icon {
        background: #2196f35e;
  
    height: 43px;
    width: 43px;
    border-radius: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.menus {

  display: flex;
  justify-content: flex-end;
  align-items: center;
          margin-top: -18px;
          margin-left: 30px;
}

.menus svg {
  margin-right: 13px;
}


 
  .custom-col {
    flex-basis: 25%;
    max-width: 25%;
    border-radius: 8px;
    min-width: 300px;
  }

.dropdown-content a {
  border-bottom: 1px solid #eee;
}


.flex-row {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
}

.flex-row2 {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

.prompt_code {
  width: 75%;
  border-right: 1px solid #e1e1e1;
}
.prompt_details {
  width: 25%;

}

.prompt_editor {
 height: 50vh;
}

.prompt_output {
 height: 33.5vh;

}

textarea{
        height: 100%;
        width: 99%;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
}


    /* Custom styling for the input field */
        .custom-input-group {
            position: relative;
        }

        .custom-input {
            border-radius: 20px; /* Rounded corners */
            padding: 10px 35px 10px 10px; /* Add padding for better appearance */
        }

        .custom-dropdown-icon {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
        }


           /* Custom styling for the search results list */
        .custom-list-group {
            margin-top: 5px; /* Add space between the input and the results */
        }

        /* Custom styling for result items */
        .result-item {
            display: flex;
            padding: 10px;
            border-bottom: 1px solid #ddd;
            border-left: 0px solid #ddd;
            border-right: 0px solid #ddd;
            margin-bottom: 0px;
            cursor: pointer;
        }

.result-item:hover {
  background-color: #2196f33d;
}
    

        .result-content {
            flex-grow: 1;
        }

        .result-name {
            font-weight: bold;
        }

        .result-description {
            color: #666;
        }



</style>
{% endblock stylesheets %}
{% load widget_tweaks %}
{% block content %}
     <div class="banner-area text-combo top-pad-90 rectangular-shape bg-light-gradient pb-2 ">

<form id="myForm" method="post">
    {% csrf_token %}
</form>



<div class="flex-row pt-1 pb-1 px-2" style="border-bottom: 1px solid #eee;
background: #071147;"  >

<div class="text-white"  style="font-size: 14px;" >

  <svg  onclick="goBack()" class="mr-3  " style="border-right: 1px solid white;margin-right: 6px;"   width="26px" height="26px"   viewBox="0 0 1024 1024" fill="#ffffff" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M669.6 849.6c8.8 8 22.4 7.2 30.4-1.6s7.2-22.4-1.6-30.4l-309.6-280c-8-7.2-8-17.6 0-24.8l309.6-270.4c8.8-8 9.6-21.6 2.4-30.4-8-8.8-21.6-9.6-30.4-2.4L360.8 480.8c-27.2 24-28 64-0.8 88.8l309.6 280z"  fill="#ffffff"></path></g></svg>


  <svg style="padding:2px" width="24px" height="24px"  viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M16.19 2H7.81C4.17 2 2 4.17 2 7.81V16.18C2 19.83 4.17 22 7.81 22H16.18C19.82 22 21.99 19.83 21.99 16.19V7.81C22 4.17 19.83 2 16.19 2ZM9.6 16.2C9.6 17.19 8.79 18 7.8 18C6.81 18 6 17.19 6 16.2C6 15.21 6.81 14.4 7.8 14.4H8.6C9.15 14.4 9.6 14.85 9.6 15.4V16.2ZM9.6 8.6C9.6 9.15 9.15 9.6 8.6 9.6H7.8C6.81 9.6 6 8.79 6 7.8C6 6.81 6.81 6 7.8 6C8.79 6 9.6 6.81 9.6 7.8V8.6ZM14.15 13.25C14.15 13.74 13.75 14.15 13.25 14.15H10.74C10.25 14.15 9.84 13.75 9.84 13.25V10.74C9.84 10.25 10.24 9.84 10.74 9.84H13.25C13.74 9.84 14.15 10.24 14.15 10.74V13.25ZM16.2 18C15.21 18 14.4 17.19 14.4 16.2V15.4C14.4 14.85 14.85 14.4 15.4 14.4H16.2C17.19 14.4 18 15.21 18 16.2C18 17.19 17.19 18 16.2 18ZM16.2 9.6H15.4C14.85 9.6 14.4 9.15 14.4 8.6V7.8C14.4 6.81 15.21 6 16.2 6C17.19 6 18 6.81 18 7.8C18 8.79 17.19 9.6 16.2 9.6Z" fill="#dfdddd"></path> </g></svg>

Prompt Writer

</div>

<div class="flex-row">
 


  <a  data-bs-toggle="modal" data-bs-target="#exampleModal"  class="  btn   btn-sm  mx-1 text-white " style="border: 0px solid #0053a6; text-transform: capitalize; 
   margin-bottom: 0px !important;" > 
          <svg class="mx-2 py-0" width="16px" height="16px"  viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" fill="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>save-floppy</title> <desc>Created with Sketch Beta.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> <g id="Icon-Set" sketch:type="MSLayerGroup" transform="translate(-152.000000, -515.000000)" fill="#ffffff"> <path d="M171,525 C171.552,525 172,524.553 172,524 L172,520 C172,519.447 171.552,519 171,519 C170.448,519 170,519.447 170,520 L170,524 C170,524.553 170.448,525 171,525 L171,525 Z M182,543 C182,544.104 181.104,545 180,545 L156,545 C154.896,545 154,544.104 154,543 L154,519 C154,517.896 154.896,517 156,517 L158,517 L158,527 C158,528.104 158.896,529 160,529 L176,529 C177.104,529 178,528.104 178,527 L178,517 L180,517 C181.104,517 182,517.896 182,519 L182,543 L182,543 Z M160,517 L176,517 L176,526 C176,526.553 175.552,527 175,527 L161,527 C160.448,527 160,526.553 160,526 L160,517 L160,517 Z M180,515 L156,515 C153.791,515 152,516.791 152,519 L152,543 C152,545.209 153.791,547 156,547 L180,547 C182.209,547 184,545.209 184,543 L184,519 C184,516.791 182.209,515 180,515 L180,515 Z" id="save-floppy" sketch:type="MSShapeGroup"> </path> </g> </g> </g></svg> Save </a>


   <a  class="  btn text-white btn-sm   " style="border: 1px solid #0053a6; text-transform: capitalize; 
   margin-bottom: 0px !important;"> 
          <svg preserveAspectRatio="xMidYMin" width="16" height="16" style="font-size:16px;rotate:0deg;margin-right:3px"  viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g clip-path="url(#clip0_15_72)"> <rect width="24" height="24" fill="none"></rect> <circle cx="7" cy="12" r="2" stroke="#ffffff" stroke-linejoin="round"></circle> <circle cx="17" cy="6" r="2" stroke="#ffffff" stroke-linejoin="round"></circle> <path d="M15 7L8.5 11" stroke="#ffffff"></path> <circle cx="17" cy="18" r="2" stroke="#ffffff" stroke-linejoin="round"></circle> <path d="M8.5 13.5L15 17" stroke="#ffffff"></path> </g> <defs> <clipPath id="clip0_15_72"> <rect width="24" height="24" fill="white"></rect> </clipPath> </defs> </g></svg> Share </a>


</div>
</div>



<div class="flex-row2">

<div class='prompt_code' >


<div class='prompt_editor' >
  <textarea data-editor="twilight" name="code"   required id="id_program" style="border: 0px solid;" >{{prompt}}</textarea>


</div>

<div class='prompt_output'  >

<div style="display: flex; border-bottom:1px solid #eee" >
   <a  onclick="run_clear()"   class="  btn   btn-sm  mt-0 mb-0 " style=" text-transform: capitalize;width:136px;color: #f44336; border:0px solid; box-shadow: none; padding-top: 10px;"> 
   <svg preserveAspectRatio="xMidYMin" width="16" height="16" style="font-size:16px;rotate:0deg;margin-right:3px"   fill="#c81414" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" stroke="#c81414"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M896 512c0-212.077-171.921-384-384-384-212.077 0-384 171.923-384 384 0 212.079 171.923 384 384 384 212.079 0 384-171.921 384-384zM579.883 398.863c12.497-12.497 32.759-12.497 45.257 0 12.493 12.497 12.493 32.757 0 45.254L557.257 512l67.878 67.883c12.497 12.497 12.497 32.759 0 45.257-12.493 12.493-32.755 12.493-45.252 0L512 557.257l-67.883 67.883c-12.497 12.493-32.757 12.493-45.254 0-12.497-12.497-12.497-32.759 0-45.257L466.744 512l-67.881-67.883c-12.497-12.497-12.497-32.758 0-45.254s32.757-12.497 45.254 0L512 466.744l67.883-67.881z"></path></g></svg>
             Clear </a>



              <div class="input-group">
     

            <input type="text" id="message-input" class="form-control" placeholder="Send a message ..." 
            style="border-radius: 0px;background: #f3f3f3a8;" >
            <div class="input-group-append" style="padding: 4px;
    padding-left: 10px;
    padding-right: 10px;
    border: 1px solid #cbcbcb;
    background: white;
    border-top-right-radius: 7px;
    border-bottom-right-radius: 7px;">
                    <i class="fa fa-caret-down"></i> <!-- Font Awesome icon -->
            </div>


        </div>


 <a onclick="run_prompt()" id='send-button1'   class="  btn   btn-sm  mt-0 mb-0 " style=" text-transform: capitalize;width:136px;color: #009612; border:0px solid; box-shadow: none; padding-top: 10px;"> 
   <svg preserveAspectRatio="xMidYMin" width="16" height="16" style="font-size:16px;rotate:0deg;margin-right:3px"   viewBox="0 0 24 24" fill="#009612" xmlns="http://www.w3.org/2000/svg" stroke="#009612"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M20.4086 9.35258C22.5305 10.5065 22.5305 13.4935 20.4086 14.6474L7.59662 21.6145C5.53435 22.736 3 21.2763 3 18.9671L3 5.0329C3 2.72368 5.53435 1.26402 7.59661 2.38548L20.4086 9.35258Z" stroke="#009612" stroke-width="1.5"></path> </g></svg>
             Run </a>


 <a id='send-button2' class="  btn   btn-sm  mt-0 mb-0 " style=" text-transform: capitalize;width:136px;color: #009612; border:0px solid; box-shadow: none; padding-top: 10px;display: none;"> 
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin:auto;background:#fff;display:block;" width="28px" height="28px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
<circle cx="84" cy="50" r="10" fill="#e15b64">
    <animate attributeName="r" repeatCount="indefinite" dur="0.25s" calcMode="spline" keyTimes="0;1" values="10;0" keySplines="0 0.5 0.5 1" begin="0s"></animate>
    <animate attributeName="fill" repeatCount="indefinite" dur="1s" calcMode="discrete" keyTimes="0;0.25;0.5;0.75;1" values="#e15b64;#abbd81;#f8b26a;#f47e60;#e15b64" begin="0s"></animate>
</circle><circle cx="16" cy="50" r="10" fill="#e15b64">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="0s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="0s"></animate>
</circle><circle cx="50" cy="50" r="10" fill="#f47e60">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.25s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.25s"></animate>
</circle><circle cx="84" cy="50" r="10" fill="#f8b26a">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.5s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.5s"></animate>
</circle><circle cx="16" cy="50" r="10" fill="#abbd81">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.75s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.75s"></animate>
</circle>
</svg> </a>





        </div>

<div>

 

 <div id="chat-container"    style="display: flex;justify-content: center;align-items: center; flex-direction:column;" > 
   <svg fill="#eee" width="64px" height="64px" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" stroke="#eee"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M520.741 163.801a10.234 10.234 0 00-3.406-3.406c-4.827-2.946-11.129-1.421-14.075 3.406L80.258 856.874a10.236 10.236 0 00-1.499 5.335c0 5.655 4.585 10.24 10.24 10.24h846.004c1.882 0 3.728-.519 5.335-1.499 4.827-2.946 6.352-9.248 3.406-14.075L520.742 163.802zm43.703-26.674L987.446 830.2c17.678 28.964 8.528 66.774-20.436 84.452a61.445 61.445 0 01-32.008 8.996H88.998c-33.932 0-61.44-27.508-61.44-61.44a61.445 61.445 0 018.996-32.008l423.002-693.073c17.678-28.964 55.488-38.113 84.452-20.436a61.438 61.438 0 0120.436 20.436zM512 778.24c22.622 0 40.96-18.338 40.96-40.96s-18.338-40.96-40.96-40.96-40.96 18.338-40.96 40.96 18.338 40.96 40.96 40.96zm0-440.32c-22.622 0-40.96 18.338-40.96 40.96v225.28c0 22.622 18.338 40.96 40.96 40.96s40.96-18.338 40.96-40.96V378.88c0-22.622-18.338-40.96-40.96-40.96z"></path></g></svg>
   <p class="text-secondary" > Empty output </p>



</div>
</div>
</div>


</div>


<div class='prompt_details py-2'>
        <h5 class="text-center font-weight-bold " style="color:black" >Model PM(s)</h5>

    <hr   />


    <div class="containere px-0 ">
        <div class="input-group mb-3 px-2">
               <div class="input-group-prepend" style="padding-top: 6px;
    padding-left: 10px;
    padding-right: 10px;
    border: 1px solid #cbcbcb;
    background: white;
    border-top-left-radius: 7px;
    border-bottom-left-radius: 7px;">
                    <i class="fa fa-search form-control-feedback"></i>
            </div>

            <input type="text" id="search-input" class="form-control" placeholder="Search PM(s) ...">
            <div class="input-group-append" style="padding: 4px;
    padding-left: 10px;
    padding-right: 10px;
    border: 1px solid #cbcbcb;
    background: white;
    border-top-right-radius: 7px;
    border-bottom-right-radius: 7px;">
                    <i class="fa fa-caret-down"></i> <!-- Font Awesome icon -->
            </div>


        </div>
            <span id="result-count" class="mt-0 " ></span> <!-- Display the number of results -->
        <div class="custom-list-group">
            <div id="search-results" class="mt-2"></div> <!-- Results as a list -->
        </div>
    </div>
    <hr   />

    <div id="model_added" class="px-3">


</div>


</div>



</div>













    </div>

 


<!-- Save Modal -->

  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content p-3">
      <form id="prompt-form" method="POST" >
        
          {% csrf_token %}

              <textarea   id="prompt" name="content" style="display:none;"   ></textarea>
              <input type="text"  id="status" name="status" value="create" style="display:none;"  >

        <div class="modal-body">
          <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input required type="text" class="form-control" id="name" name="name" placeholder="Prompt Name" value={{name}} >


   
 
          </div>
          <div class="mb-3">
            <label for="description" class="form-label">Description</label>
            <textarea class="form-control" id="description" name="description" placeholder="Description.."  >{{description}}</textarea>
          </div>

          <div class="mb-3">
    <label for="public" class="form-label">Make Public</label>
    <select class="form-select" id="public" name="is_public">
        <option value="False">No</option>
        <option value="True">Yes</option>
    </select>
</div>
 
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" id='save-button' class="btn btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>









 

<!-- share Modal -->
<div class="modal fade" id="chatModal" tabindex="-1" aria-labelledby="chatModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-xl">
    <div class="modal-content">
     
    <div class="modal-body" id='modal-body'  > 
   
  </div>
  
    </div>
  </div>
</div>
 

<!-- Share Modal -->
<div class="modal fade" id="shareModal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-xl">
    <div class="modal-content">
      <div class="modal-header" style="background:#051837">
        <h6 class="text-white pt-1"  ><svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 12C4 13.3807 5.11929 14.5 6.5 14.5C7.88071 14.5 9 13.3807 9 12C9 10.6193 7.88071 9.5 6.5 9.5" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M14 6.5L9 10" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M14 17.5L9 14" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M16.5 21C17.8807 21 19 19.8807 19 18.5C19 17.1193 17.8807 16 16.5 16C15.1193 16 14 17.1193 14 18.5" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M18.665 6.74993C17.9746 7.94566 16.4457 8.35535 15.2499 7.66499C14.0542 6.97464 13.6445 5.44566 14.3349 4.24993C15.0252 3.0542 16.5542 2.64451 17.7499 3.33487" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> </g></svg> <span class="pt-1" > Share: How to use Bot directly in your app</span></h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
    <div class="modal-body my-3"   style="    padding: 2px 16px;
    height: 29vw; ">
     
    


    <div class='share m-4' style="width: 95%; overflow-x: scroll;" > 
  <button class="bg-white p-1" onclick="CopyToClipboard('link')" class="copy p-1 " style="float: right; border: 1px solid gray; border-radius:5px; color: black; font-size: 13px; " > <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M21 8C21 6.34315 19.6569 5 18 5H10C8.34315 5 7 6.34315 7 8V20C7 21.6569 8.34315 23 10 23H18C19.6569 23 21 21.6569 21 20V8ZM19 8C19 7.44772 18.5523 7 18 7H10C9.44772 7 9 7.44772 9 8V20C9 20.5523 9.44772 21 10 21H18C18.5523 21 19 20.5523 19 20V8Z" fill="#9f9999"></path> <path d="M6 3H16C16.5523 3 17 2.55228 17 2C17 1.44772 16.5523 1 16 1H6C4.34315 1 3 2.34315 3 4V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V4C5 3.44772 5.44772 3 6 3Z" fill="#9f9999"></path> </g></svg> Copy </button>
<p class="link" style="color:#50a14f; " ><span style="color:black;" > GET: >> </span><span id="apiContainer" ></span>  </p>
<p class="link_description" style="    background: #c0c0c033;
    padding: 5px;
    border-radius: 4px;color: black;" > Access Bot via Link <span id='apiContainertooltip' ></span> </p>
    </div> 
    

        <div class='share m-4' style="width: 95%; overflow-x: scroll;" > 
  <button   class="bg-white p-1" onclick="CopyToClipboard('iframe')" class="copy p-1 " style="float: right; border: 1px solid gray; border-radius:5px; color: black; font-size: 13px; " > <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M21 8C21 6.34315 19.6569 5 18 5H10C8.34315 5 7 6.34315 7 8V20C7 21.6569 8.34315 23 10 23H18C19.6569 23 21 21.6569 21 20V8ZM19 8C19 7.44772 18.5523 7 18 7H10C9.44772 7 9 7.44772 9 8V20C9 20.5523 9.44772 21 10 21H18C18.5523 21 19 20.5523 19 20V8Z" fill="#9f9999"></path> <path d="M6 3H16C16.5523 3 17 2.55228 17 2C17 1.44772 16.5523 1 16 1H6C4.34315 1 3 2.34315 3 4V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V4C5 3.44772 5.44772 3 6 3Z" fill="#9f9999"></path> </g></svg> Copy </button>
<p class="link" style="color:#50a14f; " ><span style="color:black;" > Iframe: </span> <span id="iframeContainer" ></span> </p>
<p class="link_description" style="    background: #c0c0c033;
    padding: 5px;
    border-radius: 4px;color: black;" > Access Bot via Iframe <span id='iframeContainertooltip' ></span> </p>
    </div> 


   <div class='share m-4' style="width: 95%; overflow-x: scroll;" > 
  <button class="bg-white p-1" onclick="CopyToClipboard('api')" class="copy " style="float: right; border: 1px solid gray; border-radius:5px; color: black; font-size: 13px; " > <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M21 8C21 6.34315 19.6569 5 18 5H10C8.34315 5 7 6.34315 7 8V20C7 21.6569 8.34315 23 10 23H18C19.6569 23 21 21.6569 21 20V8ZM19 8C19 7.44772 18.5523 7 18 7H10C9.44772 7 9 7.44772 9 8V20C9 20.5523 9.44772 21 10 21H18C18.5523 21 19 20.5523 19 20V8Z" fill="#9f9999"></path> <path d="M6 3H16C16.5523 3 17 2.55228 17 2C17 1.44772 16.5523 1 16 1H6C4.34315 1 3 2.34315 3 4V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V4C5 3.44772 5.44772 3 6 3Z" fill="#9f9999"></path> </g></svg> Copy </button>
<p class="link" style="color:#50a14f; " ><span style="color:black;" > API: </span> <span id="msgApiContainer" ></span>  </p>
<p class="link_description" style="    background: #c0c0c033;
    padding: 5px;
    border-radius: 4px;color: black;" > Access Bot via API <span id='msgApiContainertooltip' ></span> </p>
    </div> 



  </div>
  
    </div>
  </div>
</div>



 

<!-- Delete Chat Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title text-white py-2" id="deleteModalLabel">Delete Chatbot</h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body px-5 ">
    <p class="text-center my-4 text-danger" ><svg style="margin-right:5px; margin-top:-2px;" width="22px" height="22px"  viewBox="0 -5 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>delete</title> <desc>Created with Sketch Beta.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> <g id="Icon-Set-Filled" sketch:type="MSLayerGroup" transform="translate(-518.000000, -1146.000000)" fill="#bd0f0f"> <path d="M540.647,1159.24 C541.039,1159.63 541.039,1160.27 540.647,1160.66 C540.257,1161.05 539.623,1161.05 539.232,1160.66 L536.993,1158.42 L534.725,1160.69 C534.331,1161.08 533.692,1161.08 533.298,1160.69 C532.904,1160.29 532.904,1159.65 533.298,1159.26 L535.566,1156.99 L533.327,1154.76 C532.936,1154.37 532.936,1153.73 533.327,1153.34 C533.718,1152.95 534.352,1152.95 534.742,1153.34 L536.981,1155.58 L539.281,1153.28 C539.676,1152.89 540.314,1152.89 540.708,1153.28 C541.103,1153.68 541.103,1154.31 540.708,1154.71 L538.408,1157.01 L540.647,1159.24 L540.647,1159.24 Z M545.996,1146 L528.051,1146 C527.771,1145.98 527.485,1146.07 527.271,1146.28 L518.285,1156.22 C518.074,1156.43 517.983,1156.71 517.998,1156.98 C517.983,1157.26 518.074,1157.54 518.285,1157.75 L527.271,1167.69 C527.467,1167.88 527.723,1167.98 527.979,1167.98 L527.979,1168 L545.996,1168 C548.207,1168 550,1166.21 550,1164 L550,1150 C550,1147.79 548.207,1146 545.996,1146 L545.996,1146 Z" id="delete" sketch:type="MSShapeGroup"> </path> </g> </g> </g></svg>  Are you sure you want to delete this bot? </p>
      <div class="modal-footer" style="width: 100%;">

        <a type="button" href="" id="deleteBtn" class="btn circle btn-md btn-danger wow fadeInUp" style="    height: 40px"    role="button" aria-pressed="true"> Delete »</a>

      </div>
    </div>
  </div>
</div>
</div>










<!-- Create Chat Bot -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title text-white py-2" id="exampleModalLabel">Create Personalized Chatbot</h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body mx-2 ">
    {% include 'home/chatbot_form.html' %}
      <div class="modal-footer"   >
     
        <button type="button" id="submitBtn" class="btn circle btn-md btn-success wow fadeInUp" style="    height: 40px"    role="button" aria-pressed="true">Create Bot Prompt »</button>

      </div>
    </div>
    
    </div>
  </div>
</div>











    {% include "includes/footer.html" %}
    
  </div>

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}

 
  <script src="{% static 'ace/ace.js' %}"></script> 

<!-- <script src="//ajaxorg.github.io/ace-builds/src-min-noconflict/ace.js"></script> -->
<!--  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
 -->

     <script>

  localStorage.setItem('writer_used_model',"")
 localStorage.setItem("textarea[data-editor]", "")
      $('#model_added').html(`<div style="display: flex;justify-content: center;align-items: center; flex-direction:column;" > 
   <svg fill="#0053a6" width="64px" height="64px" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" stroke="#eee"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M520.741 163.801a10.234 10.234 0 00-3.406-3.406c-4.827-2.946-11.129-1.421-14.075 3.406L80.258 856.874a10.236 10.236 0 00-1.499 5.335c0 5.655 4.585 10.24 10.24 10.24h846.004c1.882 0 3.728-.519 5.335-1.499 4.827-2.946 6.352-9.248 3.406-14.075L520.742 163.802zm43.703-26.674L987.446 830.2c17.678 28.964 8.528 66.774-20.436 84.452a61.445 61.445 0 01-32.008 8.996H88.998c-33.932 0-61.44-27.508-61.44-61.44a61.445 61.445 0 018.996-32.008l423.002-693.073c17.678-28.964 55.488-38.113 84.452-20.436a61.438 61.438 0 0120.436 20.436zM512 778.24c22.622 0 40.96-18.338 40.96-40.96s-18.338-40.96-40.96-40.96-40.96 18.338-40.96 40.96 18.338 40.96 40.96 40.96zm0-440.32c-22.622 0-40.96 18.338-40.96 40.96v225.28c0 22.622 18.338 40.96 40.96 40.96s40.96-18.338 40.96-40.96V378.88c0-22.622-18.338-40.96-40.96-40.96z"></path></g></svg>
   <p class="text-dark font-weight-bold mt-2 mb-0" > No Model Selected </p>
   <p class="text-secondary" > Add a Model </p>
 </div>`)


      $(function () {
                    $('textarea[data-editor]').each(function () {
                var textarea = $(this);
                var theme = textarea.data('editor');
                var editDiv = $('<div>', {
                    position: 'absolute', 
                    height: textarea.height(),
                   'class': textarea.attr('class')
                 }).insertBefore(textarea);

                textarea.css('visibility', 'hidden');
                ace.require("ace/ext/language_tools");
                var editor = ace.edit(editDiv[0]);

                editor.setOptions({enableLiveAutocompletion: true, cursorStyle: 'ace', showGutter: true, showLineNumbers: true});
                editor.setFontSize(16);
                editor.getSession().setValue(textarea.val());
                editor.getSession().setMode("ace/mode/python");

 

          textarea.val(editor.getSession().getValue());
         localStorage.setItem("textarea[data-editor]",editor.getSession().getValue()) 
         $('#prompt-form #prompt').val( editor.getSession().getValue())   

// Add an onchange event handler

    editor.getSession().on('change', function () {
         localStorage.setItem("textarea[data-editor]",editor.getSession().getValue()) 
          $('#prompt-form #prompt').val( editor.getSession().getValue())  
    });


          
          });
        });



 


function formatDate(inputDate) {
    const options = { year: 'numeric', month: 'short', day: 'numeric' };
    const date = new Date(inputDate);
    return date.toLocaleDateString('en-US', options);
}


function run_clear(){

         $('#send-button2').hide()
    $('#send-button1').show()

  var chatContainer = $("#chat-container").html( `
     <div id="chat-container"  class="mt-3" style="display: flex;justify-content: center;align-items: center; flex-direction:column;" > 
   <svg fill="#eee" width="64px" height="64px" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" stroke="#eee"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M520.741 163.801a10.234 10.234 0 00-3.406-3.406c-4.827-2.946-11.129-1.421-14.075 3.406L80.258 856.874a10.236 10.236 0 00-1.499 5.335c0 5.655 4.585 10.24 10.24 10.24h846.004c1.882 0 3.728-.519 5.335-1.499 4.827-2.946 6.352-9.248 3.406-14.075L520.742 163.802zm43.703-26.674L987.446 830.2c17.678 28.964 8.528 66.774-20.436 84.452a61.445 61.445 0 01-32.008 8.996H88.998c-33.932 0-61.44-27.508-61.44-61.44a61.445 61.445 0 018.996-32.008l423.002-693.073c17.678-28.964 55.488-38.113 84.452-20.436a61.438 61.438 0 0120.436 20.436zM512 778.24c22.622 0 40.96-18.338 40.96-40.96s-18.338-40.96-40.96-40.96-40.96 18.338-40.96 40.96 18.338 40.96 40.96 40.96zm0-440.32c-22.622 0-40.96 18.338-40.96 40.96v225.28c0 22.622 18.338 40.96 40.96 40.96s40.96-18.338 40.96-40.96V378.88c0-22.622-18.338-40.96-40.96-40.96z"></path></g></svg>
   <p class="text-secondary" > Empty output </p>



</div>
`)


}

function run_prompt() {
const model =   localStorage.getItem('writer_used_model')
if (model){

  


  const item = JSON.parse(model)
  const txt_val =  localStorage.getItem("textarea[data-editor]")

  var csrfToken = $("input[name=csrfmiddlewaretoken]").val();
  var message = $("#message-input").val();

if (!message){
  alert("No message provided!")
} else {
    $('#send-button1').hide()
    $('#send-button2').show()

    $.ajax({
            type: 'POST',
            url: '/customer/run_prompt',  // Replace with your Django view URL
            headers: {
            'X-CSRFToken': csrfToken // Include the CSRF token in the headers
        },
            data: { 'pk': item.pk,
            'prompt': txt_val,
            'message':message
             },
            success: function (data) {
                 
                 displayResponse(data.response);

                   $('#send-button2').hide()
    $('#send-button1').show()

            },
            error:function(err){
              alert("Error: ",err.status)

                   $('#send-button2').hide()
    $('#send-button1').show()

            }
        });

  }
} else {
  alert("No model selected.")
}




}


function selectModel(item) {

  localStorage.setItem('writer_used_model',JSON.stringify(item))

 
          $('#search-results').text("")
          $('#search-input').val("")
                $('#result-count').empty();


  $('#model_added').html(`<h5>Running Model</h5>

<p style="font-size: 12px;" >PUBLISHED  <svg style="margin-right: 3px; " preserveAspectRatio="xMidYMin" width="16" height="16" viewBox="0 0 24 24" fill="red" aria-hidden="true" class="css-492dz9"><path fill-rule="evenodd" clip-rule="evenodd" d="M20.7146 11.1371C20.5388 6.22883 15.7439 2.35414 11.1244 2.78226L11.1045 2.78411L11.0846 2.78489C6.38998 2.96884 2.86359 7.16608 3.28439 11.029L3.28675 11.0507L3.28785 11.0724C3.48669 15.0118 7.36507 18.0207 10.9734 17.6246L10.9936 17.6224L11.0139 17.6213C14.6969 17.4182 17.3174 14.097 16.9356 11.2085L16.9327 11.1868L16.9311 11.1648C16.7141 8.19198 13.7503 6.05168 11.1574 6.40837L11.1372 6.41115L11.1168 6.41283C8.44417 6.63315 6.72879 9.06894 7.06267 10.9812L7.0666 11.0038L7.06915 11.0265C7.29464 13.033 9.33949 14.3087 10.9126 14.0039L10.9331 14L10.9538 13.9971C12.6215 13.7697 13.4239 12.2374 13.1704 11.3075L13.1642 11.2846L13.1594 11.2614C13.0552 10.755 12.7404 10.382 12.3562 10.1626C11.9536 9.93277 11.552 9.9118 11.314 9.99929C10.9253 10.1422 10.4942 9.94297 10.3513 9.55421C10.2083 9.16544 10.4076 8.7344 10.7964 8.59145C11.5396 8.31815 12.4048 8.46307 13.1 8.86004C13.808 9.26433 14.418 9.9712 14.6238 10.9361C15.1278 12.8483 13.595 15.139 11.1771 15.4805C8.78103 15.931 5.91872 14.0977 5.58113 11.2166C5.09659 8.35143 7.54114 5.21406 10.9733 4.91961C14.3744 4.46456 18.1307 7.17864 18.4255 11.0338C18.9166 14.8604 15.5658 18.861 11.1167 19.1178C6.70736 19.5893 2.04791 15.9967 1.79088 11.1698C1.28302 6.37529 5.54313 1.51228 11.0059 1.28684C16.4202 0.797246 21.9914 5.2602 22.2129 11.0615C22.7433 16.8283 17.5595 22.5672 11.0763 22.7497C10.6622 22.7614 10.3171 22.4351 10.3055 22.0211C10.2938 21.607 10.62 21.2619 11.0341 21.2503C16.738 21.0898 21.1741 16.0142 20.7175 11.1808L20.7154 11.159L20.7146 11.1371Z"></path></svg>  ${item.connector__date_created} (${item.get_prompts})</p>

<h1 class="font-weight-bold" style="color: black;" >${item.name}</h1>
<p class="text-secondary mb-1" >${item.description} </p>
<a href='/customer/profile' class="my-0  text-dark " style="font-size: 14px; " > <svg width="24px" height="24px" fill="#000000" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><title>Account Settings</title><path d="M9.6,3.32a3.86,3.86,0,1,0,3.86,3.85A3.85,3.85,0,0,0,9.6,3.32M16.35,11a.26.26,0,0,0-.25.21l-.18,1.27a4.63,4.63,0,0,0-.82.45l-1.2-.48a.3.3,0,0,0-.3.13l-1,1.66a.24.24,0,0,0,.06.31l1,.79a3.94,3.94,0,0,0,0,1l-1,.79a.23.23,0,0,0-.06.3l1,1.67c.06.13.19.13.3.13l1.2-.49a3.85,3.85,0,0,0,.82.46l.18,1.27a.24.24,0,0,0,.25.2h1.93a.24.24,0,0,0,.23-.2l.18-1.27a5,5,0,0,0,.81-.46l1.19.49c.12,0,.25,0,.32-.13l1-1.67a.23.23,0,0,0-.06-.3l-1-.79a4,4,0,0,0,0-.49,2.67,2.67,0,0,0,0-.48l1-.79a.25.25,0,0,0,.06-.31l-1-1.66c-.06-.13-.19-.13-.31-.13L19.5,13a4.07,4.07,0,0,0-.82-.45l-.18-1.27a.23.23,0,0,0-.22-.21H16.46M9.71,13C5.45,13,2,14.7,2,16.83v1.92h9.33a6.65,6.65,0,0,1,0-5.69A13.56,13.56,0,0,0,9.71,13m7.6,1.43a1.45,1.45,0,1,1,0,2.89,1.45,1.45,0,0,1,0-2.89Z"></path></g></svg> ${item.connector__created_by__username} </a>
<hr />
<li class=" text-capitalize mt-0 mb-1 font-weight-bold list-group-item py-2 " style="font-size: 14px;color: black;display:flex; justify-content:space-between;"  > <div> Connector: </div> <span  style="color:#747575;"  > ${item.connector__type_name} </span> </li>


<li class=" text-capitalize mt-0 mb-1 font-weight-bold list-group-item py-2 " style="font-size: 14px;color: black;display:flex; justify-content:space-between;"  > <div> Updated: </div> <span  style="color:#747575;"  >  ${formatDate(item.last_date_update)} : ${formatTime(item.last_time_update)} </span> </li>
 
   <hr />

<div>




     <a  id="taskbot" href="/customer/ai_models/${item.pk}"  class="  btn text-white btn-sm w-100 mt-0 " style="background:#0053a6; text-transform: capitalize;"> 
             Create Task Bot  <svg preserveAspectRatio="xMidYMin" width="16" height="16" style="font-size:16px;rotate:0deg;margin-left:3px;margin-top:-3px" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="css-492dz9"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 3C14.25 2.58579 14.5858 2.25 15 2.25H21C21.4142 2.25 21.75 2.58579 21.75 3V9C21.75 9.41421 21.4142 9.75 21 9.75C20.5858 9.75 20.25 9.41421 20.25 9V4.81066L10.5303 14.5303C10.2374 14.8232 9.76256 14.8232 9.46967 14.5303C9.17678 14.2374 9.17678 13.7626 9.46967 13.4697L19.1893 3.75H15C14.5858 3.75 14.25 3.41421 14.25 3ZM5 6.75C4.66848 6.75 4.35054 6.8817 4.11612 7.11612C3.8817 7.35054 3.75 7.66848 3.75 8V19C3.75 19.3315 3.8817 19.6495 4.11612 19.8839C4.35054 20.1183 4.66848 20.25 5 20.25H16C16.3315 20.25 16.6495 20.1183 16.8839 19.8839C17.1183 19.6495 17.25 19.3315 17.25 19V13C17.25 12.5858 17.5858 12.25 18 12.25C18.4142 12.25 18.75 12.5858 18.75 13V19C18.75 19.7293 18.4603 20.4288 17.9445 20.9445C17.4288 21.4603 16.7293 21.75 16 21.75H5C4.27065 21.75 3.57118 21.4603 3.05546 20.9445C2.53973 20.4288 2.25 19.7293 2.25 19V8C2.25 7.27065 2.53973 6.57118 3.05546 6.05546C3.57118 5.53973 4.27065 5.25 5 5.25H11C11.4142 5.25 11.75 5.58579 11.75 6C11.75 6.41421 11.4142 6.75 11 6.75H5Z"></path></svg>  </a>


</div>`)




}


function formatTime(inputTime) {
    const options = { hour: 'numeric', minute: '2-digit', hour12: true };
    if (inputTime){
          const timeParts = inputTime.split(':');
    const hours = parseInt(timeParts[0]);
    const minutes = parseInt(timeParts[1]);
    const seconds = parseFloat(timeParts[2]);

    const date = new Date();
    date.setHours(hours);
    date.setMinutes(minutes);
    date.setSeconds(seconds);

    return date.toLocaleTimeString('en-US', options);
  } else {
    return ""
  }

}


                // search.js
$(document).ready(function () {


   const saveButton = $('#save-button');

    // Add a click event listener to the Save button
    saveButton.on('click', function (evt) {

      evt.preventDefault()
        // Serialize the form data
        const formData = $('#prompt-form').serialize();

        // Send a POST request to the Django view
        $.ajax({
            type: 'POST',
            url: "",
            data: formData,
            success: function (res) {
                  $('#exampleModal').modal('hide');
                 alert(res.message);
            },
            error: function (error) {
                 $('#exampleModal').modal('hide');
                alert('Error:'+ error);
            },
        });
    });






    $('#search-input').on('input', function () {
        const query = $(this).val();

        if (!query){
          $('#search-results').text("")
                $('#result-count').empty();

        } else {

        // Send an Ajax request to the Django view
        $.ajax({
            type: 'GET',
            url: '/customer/prompt_writer/search',  // Replace with your Django view URL
            data: { 'q': query },
            success: function (data) {
                // Clear previous results
                $('#search-results').empty();
                $('#result-count').text(data.results.length + " results found.");

                // Display the results
  if (data.results.length > 0) {
                    const resultsList = $('<ul style="padding-left:0px;" >');
                    $.each(data.results, function (index, item) {
                        // Create a list item with Bootstrap classes
                        const listItem = $('<li>').click(function () {
    selectModel(item);
}).addClass('list-group-item result-item');
                        
                        // Create the result content container
                        const resultContent = $('<div>').addClass('result-content');
                        
                        // Create and append the image element
                        const resultInfo = $('<div>').addClass('result-info').html(`<div class="mt-1" style="display: flex;flex-direction: row; align-items:center;">
      
        <svg style="margin-left: -1px;" width="64px" height="64px" viewBox="0 0 1024 1024" class="icon" xmlns="http://www.w3.org/2000/svg" fill="#12116f"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill="#0ea427" d="M512 64a448 448 0 110 896 448 448 0 010-896zm-55.808 536.384l-99.52-99.584a38.4 38.4 0 10-54.336 54.336l126.72 126.72a38.272 38.272 0 0054.336 0l262.4-262.464a38.4 38.4 0 10-54.272-54.336L456.192 600.384z"></path></g></svg>
      

<span style="font-size: 13px; margin-left: 5px;"> Prompts: (${item.get_prompts})  </span> <svg style="margin-right: 3px;margin-left: 5px;" preserveAspectRatio="xMidYMin" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="css-492dz9"><path fill-rule="evenodd" clip-rule="evenodd" d="M20.7146 11.1371C20.5388 6.22883 15.7439 2.35414 11.1244 2.78226L11.1045 2.78411L11.0846 2.78489C6.38998 2.96884 2.86359 7.16608 3.28439 11.029L3.28675 11.0507L3.28785 11.0724C3.48669 15.0118 7.36507 18.0207 10.9734 17.6246L10.9936 17.6224L11.0139 17.6213C14.6969 17.4182 17.3174 14.097 16.9356 11.2085L16.9327 11.1868L16.9311 11.1648C16.7141 8.19198 13.7503 6.05168 11.1574 6.40837L11.1372 6.41115L11.1168 6.41283C8.44417 6.63315 6.72879 9.06894 7.06267 10.9812L7.0666 11.0038L7.06915 11.0265C7.29464 13.033 9.33949 14.3087 10.9126 14.0039L10.9331 14L10.9538 13.9971C12.6215 13.7697 13.4239 12.2374 13.1704 11.3075L13.1642 11.2846L13.1594 11.2614C13.0552 10.755 12.7404 10.382 12.3562 10.1626C11.9536 9.93277 11.552 9.9118 11.314 9.99929C10.9253 10.1422 10.4942 9.94297 10.3513 9.55421C10.2083 9.16544 10.4076 8.7344 10.7964 8.59145C11.5396 8.31815 12.4048 8.46307 13.1 8.86004C13.808 9.26433 14.418 9.9712 14.6238 10.9361C15.1278 12.8483 13.595 15.139 11.1771 15.4805C8.78103 15.931 5.91872 14.0977 5.58113 11.2166C5.09659 8.35143 7.54114 5.21406 10.9733 4.91961C14.3744 4.46456 18.1307 7.17864 18.4255 11.0338C18.9166 14.8604 15.5658 18.861 11.1167 19.1178C6.70736 19.5893 2.04791 15.9967 1.79088 11.1698C1.28302 6.37529 5.54313 1.51228 11.0059 1.28684C16.4202 0.797246 21.9914 5.2602 22.2129 11.0615C22.7433 16.8283 17.5595 22.5672 11.0763 22.7497C10.6622 22.7614 10.3171 22.4351 10.3055 22.0211C10.2938 21.607 10.62 21.2619 11.0341 21.2503C16.738 21.0898 21.1741 16.0142 20.7175 11.1808L20.7154 11.159L20.7146 11.1371Z"></path></svg> <span style="font-size: 13px;"> ${formatDate(item.last_date_update)} : ${formatTime(item.last_time_update)} </span>

</div>`);
                        resultContent.append(resultInfo);
                        
                        // Create and append the name element
                        const resultName = $('<div>').addClass('result-name').text(item.name);
                        resultContent.append(resultName);

                        // Create and append the description element
                        const resultDescription = $('<div>').addClass('result-description').text(item.description.slice(0,30));
                        resultContent.append(resultDescription);
                        resultContent.append(resultInfo);


                        // Append the result content container to the list item
                        listItem.append(resultContent);

                        // Append the list item to the results list
                        resultsList.append(listItem);
                    });
                    // Append the results list to the search-results div
         $('#search-results').attr('style','max-height: 30vh; overflow-y: scroll;')
                    $('#search-results').append(resultsList);
                } else {
                    // No results found
                $('#result-count').empty();
                    $('#search-results').text('No results found.');
                }
            }
        });

}


    });
});




</script>




  <script>

 animationIcon = `     <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin:auto;background:#fff;display:block;" width="28px" height="28px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
<circle cx="84" cy="50" r="10" fill="#e15b64">
    <animate attributeName="r" repeatCount="indefinite" dur="0.25s" calcMode="spline" keyTimes="0;1" values="10;0" keySplines="0 0.5 0.5 1" begin="0s"></animate>
    <animate attributeName="fill" repeatCount="indefinite" dur="1s" calcMode="discrete" keyTimes="0;0.25;0.5;0.75;1" values="#e15b64;#abbd81;#f8b26a;#f47e60;#e15b64" begin="0s"></animate>
</circle><circle cx="16" cy="50" r="10" fill="#e15b64">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="0s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="0s"></animate>
</circle><circle cx="50" cy="50" r="10" fill="#f47e60">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.25s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.25s"></animate>
</circle><circle cx="84" cy="50" r="10" fill="#f8b26a">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.5s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.5s"></animate>
</circle><circle cx="16" cy="50" r="10" fill="#abbd81">
  <animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.75s"></animate>
  <animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.75s"></animate>
</circle>
</svg>`


 function goBack() {
      window.history.back();
    }



function CopyToClipboard(link){
  if (link === 'api'){
    var copyText = document.getElementById("msgApiContainer");
     var tooltipEl = document.getElementById("msgApiContainertooltip")
  } else if (link === 'iframe'){
    var copyText = document.getElementById("iframeContainer");
     var tooltipEl = document.getElementById("iframeContainertooltip")
  } else {
    var copyText = document.getElementById("apiContainer");
     var tooltipEl = document.getElementById("apiContainertooltip")
  }
   
  navigator.clipboard.writeText(copyText.textContent);
  // console.log(tooltipEl)
  tooltipEl.innerHTML= ` <svg style="margin-left: 5px;" width="64px" height="64px" viewBox="0 0 1024 1024" class="icon" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill="#0ea427" d="M512 64a448 448 0 110 896 448 448 0 010-896zm-55.808 536.384l-99.52-99.584a38.4 38.4 0 10-54.336 54.336l126.72 126.72a38.272 38.272 0 0054.336 0l262.4-262.464a38.4 38.4 0 10-54.272-54.336L456.192 600.384z"></path></g></svg> Copied`

}


$(".share-chat-btn").click(function(event) {


   var api_id = $(this).attr('api_id')

var apiString =   `${document.location.origin}/customer/chatbot/iframe/${api_id}?user_id={{user}}`
    var apiContainer = document.getElementById('apiContainer');
        apiContainer.textContent = apiString;


var msgApiContainerString =   `${document.location.origin}/customer/process_message?message=who+develop+pye&api_id=${api_id}?user_id={{user}}`
    var msgApiContainer = document.getElementById('msgApiContainer');
        msgApiContainer.textContent = msgApiContainerString;


var iframeString = `<iframe id="iframe" src="${document.location.origin}/customer/chatbot/iframe/${api_id}?user_id={{user}}" width="100%" height="100%" frameborder="0"></iframe>`;
        var iframeContainer = document.getElementById('iframeContainer');
        iframeContainer.textContent = iframeString;

})
$(".chat-btn").click(function(event) {

   var api_id = $(this).attr('api_id')

$("#chatModal #modal-body").html( `<iframe src="/customer/chatbot/iframe/${api_id}?user_id={{user}}" width="100%" height="600" frameborder="0"></iframe>`)
//     getMessage( pk) 
$("#chat-modal-header").text("Preview - "+$(this).attr('chat-name') +" (Bot)")
// localStorage.setItem("selectedConn",pk)
});
    
$(".delete-bot").click(function(event) {  
localStorage.setItem("selectedConn",$(this).attr('pk'))

$("#deleteBtn").attr('href',`/customer/chatbot/delete?pk=${$(this).attr('pk')}&connections_pk={{connection.pk}}`)
$("h6#deleteModalLabel").text("Delete Chatbot (" + $(this).attr('chat-name')+")" )
$("input#prompts_pk").val($(this).attr('pk') )
// localStorage.setItem("selectedConn",pk)
});
    
 

 

 $(".create-bot").click(function(event) {  
localStorage.setItem("selectedConn",$(this).attr('pk'))

$("h6#exampleModalLabel").text("Create Personalized bot for " + $(this).attr('chat-name') )
$("input#connections_pk").val($(this).attr('pk') )
// localStorage.setItem("selectedConn",pk)
});





  // Make an AJAX request to the server
  let sendIcon = `<svg width="36px" height="36px" viewBox="0 0 24 24" fill="#051837" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M18.7 8.97989L4.14 17.7099C4.05 17.3799 4 17.0299 4 16.6699V7.32989C4 4.24989 7.33 2.32989 10 3.86989L14.04 6.19989L18.09 8.53989C18.31 8.66989 18.52 8.80989 18.7 8.97989Z" fill="#e2e3e4"></path> <path opacity="0.4" d="M18.0907 15.4598L14.0407 17.7998L10.0007 20.1298C8.0907 21.2298 5.8407 20.5698 4.7207 18.9598L5.1407 18.7098L19.5807 10.0498C20.5807 11.8498 20.0907 14.3098 18.0907 15.4598Z" fill="#051837"></path> </g></svg>`





 
 
 

// Display bot response in the chat container
function displayResponse(response) {
  var chatContainer = document.getElementById('chat-container');
  chatContainer.setAttribute('style','display: flex;justify-content: flex-start;align-items: flex-start; flex-direction:column;')
  var messageElement = document.createElement('pre');
 
  messageElement.classList.add('message', 'bot-message');

// Regular expression to match words enclosed in ```
let regex = /```([^`]+)```/g;

// Replace matches with wrapped content
const wrappedText = response.replace(regex, '<div class="code-class">$1</div>');
  messageElement.innerHTML  = wrappedText ;

var show_chat_history = "{{configs.show_chat_history}}"
  chatContainer.replaceChildren( messageElement);
 

}



 
 
 

function changeResultsPerPage(resultsPerPage) {
    // Get the current URL and remove the existing 'page' query parameter
    const url = window.location.href;
    const urlWithoutPage = url.replace(/[\?&]page=\d+/gi, '');

    // Redirect to the new URL with the updated 'per_page' query parameter
    window.location.href = `${urlWithoutPage}?per_page=${resultsPerPage}`;
  }




  </script>
{% endblock javascripts %}

